<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Cardboard Template R2</title>
</head>
<body>
<script src="../js/three.min.js"></script>
<script src="../js/StereoEffect.js"></script>
<script src="../js/DeviceOrientationControls.js"></script>
<script src="../js/DetectScreenSize.js"></script>
<script>
	var info, stats, renderer, scene, camera, controls;
	var effect;

	var controls = undefined;

	var hasOrientation = function(evt) {
		if (!evt.alpha) {
			return;
		}
		window.removeEventListener('deviceorientation', hasOrientation, false);
		controls = new THREE.DeviceOrientationControls( camera );
		controls.connect();
	};

	init();
	animate();

	function init() {
		var geometry, material, mesh;

		document.body.style.cssText = 'font: 600 12pt monospace; margin: 0; overflow: hidden' ;

		var info = document.body.appendChild( document.createElement( 'div' ) );

		info.style.cssText = 'left: 10px; position: absolute; ';
		info.innerHTML = '<h3>' + document.title + '</h3>' +
			'<div id=msg>readout</div>';

		var container = document.body.appendChild( document.createElement( 'div' ) );

		renderer = new THREE.WebGLRenderer( { alpha: 1, antialias: true, clearColor: 0xffffff }  );
		renderer.setSize( window.innerWidth, window.innerHeight );
		container.appendChild( renderer.domElement );
		scene = new THREE.Scene();
		scene.autoUpdate = false;

		camera = new THREE.PerspectiveCamera( 40, window.innerWidth / window.innerHeight, 1, 5000 );
		scene.add( camera );

		effect = new THREE.StereoEffect( renderer );
		effect.separation = 0.2;
		effect.targetDistance = 50;
		effect.setSize( window.innerWidth, window.innerHeight );

		geometry = new THREE.SphereGeometry(5,32,32);
		material = new THREE.MeshNormalMaterial();
		mesh = new THREE.Mesh( geometry, material );
		mesh.position.set(4.102740,3.857760,5.750259); scene.add( mesh );
		mesh.position.set(0.070444,2.183772,7.413751); scene.add( mesh );
		mesh.position.set(3.961852,9.899291,3.025748); scene.add( mesh );
		mesh.position.set(7.994147,8.225304,1.362256); scene.add( mesh );
		mesh.position.set(3.961852,8.225304,3.025748); scene.add( mesh );
		mesh.position.set(7.994147,9.899291,1.362256); scene.add( mesh );
		mesh.position.set(4.102740,2.183772,5.750259); scene.add( mesh );
		mesh.position.set(0.070444,3.857760,7.413751); scene.add( mesh );
		mesh.position.set(5.469986,3.020766,5.224392); scene.add( mesh );
		mesh.position.set(1.437691,3.020766,7.939618); scene.add( mesh );
		mesh.position.set(2.594605,9.062298,3.551615); scene.add( mesh );
		mesh.position.set(6.626901,9.062298,0.836389); scene.add( mesh );
		mesh.position.set(4.226072,3.919323,3.320937); scene.add( mesh );
		mesh.position.set(0.193776,2.122209,1.067066); scene.add( mesh );
		mesh.position.set(3.838520,9.960855,5.455069); scene.add( mesh );
		mesh.position.set(7.870815,8.163740,7.708941); scene.add( mesh );
		mesh.position.set(3.838520,8.163740,5.455069); scene.add( mesh );
		mesh.position.set(7.870815,9.960855,7.708941); scene.add( mesh );
		mesh.position.set(4.226072,2.122209,3.320937); scene.add( mesh );
		mesh.position.set(0.193776,3.919323,1.067066); scene.add( mesh );
		mesh.position.set(2.789292,3.020766,3.895336); scene.add( mesh );
		mesh.position.set(6.821588,3.020766,0.492667); scene.add( mesh );
		mesh.position.set(5.275299,9.062298,4.880671); scene.add( mesh );
		mesh.position.set(1.243003,9.062298,8.283340); scene.add( mesh );
		mesh.position.set(4.032296,0.000000,0.000000); scene.add( mesh );
		mesh.position.set(4.032296,0.000000,8.776007); scene.add( mesh );
		mesh.position.set(4.032296,12.083063,0.000000); scene.add( mesh );
		mesh.position.set(4.032296,12.083063,8.776007); scene.add( mesh );
		mesh.position.set(0.000000,6.041532,4.388003); scene.add( mesh );
		mesh.position.set(8.064591,6.041532,4.388003); scene.add( mesh );
		mesh.position.set(4.032296,6.041532,0.000000); scene.add( mesh );
		mesh.position.set(4.032296,6.041532,8.776007); scene.add( mesh );
		mesh.position.set(0.000000,0.000000,4.388003); scene.add( mesh );
		mesh.position.set(0.000000,12.083063,4.388003); scene.add( mesh );
		mesh.position.set(8.064591,0.000000,4.388003); scene.add( mesh );
		mesh.position.set(8.064591,12.083063,4.388003); scene.add( mesh );
		mesh.position.set(3.879593,3.020766,3.841679); scene.add( mesh );
		mesh.position.set(7.911888,3.020766,0.546324); scene.add( mesh );
		mesh.position.set(4.184999,9.062298,4.934327); scene.add( mesh );
		mesh.position.set(0.152703,9.062298,8.229683); scene.add( mesh );
		mesh.position.set(3.765930,3.020766,0.158977); scene.add( mesh );
		mesh.position.set(7.798226,3.020766,4.229026); scene.add( mesh );
		mesh.position.set(4.298661,9.062298,8.617029); scene.add( mesh );
		mesh.position.set(0.266365,9.062298,4.546980); scene.add( mesh );
		mesh.position.set(6.417608,0.354759,6.923857); scene.add( mesh );
		mesh.position.set(2.385313,5.686773,6.240153); scene.add( mesh );
		mesh.position.set(1.646983,6.396290,1.852150); scene.add( mesh );
		mesh.position.set(5.679279,11.728305,2.535854); scene.add( mesh );
		mesh.position.set(1.646983,11.728305,1.852150); scene.add( mesh );
		mesh.position.set(5.679279,6.396290,2.535854); scene.add( mesh );
		mesh.position.set(6.417608,5.686773,6.923857); scene.add( mesh );
		mesh.position.set(2.385313,0.354759,6.240153); scene.add( mesh );
		mesh.position.set(4.428550,3.020766,5.232694); scene.add( mesh );
		mesh.position.set(0.396254,3.020766,7.931316); scene.add( mesh );
		mesh.position.set(3.636042,9.062298,3.543313); scene.add( mesh );
		mesh.position.set(7.668337,9.062298,0.844691); scene.add( mesh );
		mesh.position.set(-0.152703,3.020766,0.546324); scene.add( mesh );
		mesh.position.set(8.217294,9.062298,8.229683); scene.add( mesh );
		mesh.position.set(8.258367,2.122209,1.067066); scene.add( mesh );
		mesh.position.set(8.258367,3.919323,1.067066); scene.add( mesh );
		mesh.position.set(-0.193776,8.163740,7.708941); scene.add( mesh );
		mesh.position.set(-0.193776,9.960855,7.708941); scene.add( mesh );
		mesh.position.set(-1.243003,3.020766,0.492667); scene.add( mesh );
		mesh.position.set(9.307594,9.062298,8.283340); scene.add( mesh );
		mesh.position.set(3.765930,3.020766,8.934984); scene.add( mesh );
		mesh.position.set(-0.266366,3.020766,4.229026); scene.add( mesh );
		mesh.position.set(4.298661,9.062298,-0.158977); scene.add( mesh );
		mesh.position.set(8.330956,9.062298,4.546980); scene.add( mesh );
		mesh.position.set(6.417608,12.437822,6.923857); scene.add( mesh );
		mesh.position.set(5.679279,-0.354759,2.535854); scene.add( mesh );
		mesh.position.set(1.646983,-0.354759,1.852150); scene.add( mesh );
		mesh.position.set(2.385313,12.437822,6.240153); scene.add( mesh );
		
		for (var i = 0; i < 50; i++) {
			geometry = new THREE.CylinderGeometry( 1, 150, 1000, 3, 1, 0 );
			material = new THREE.MeshNormalMaterial();
			mesh = new THREE.Mesh( geometry, material );
			mesh.position.set( Math.random() * 5000 - 2500 , 250, Math.random() * 5000 - 2500 );
			scene.add( mesh );
		}

		window.addEventListener('deviceorientation', hasOrientation, false);

		window.addEventListener( 'touchend', function () {
			if ( isFullscreen === false ) {
				document.body.webkitRequestFullscreen();
				isFullscreen = true;
			} else {
				document.webkitExitFullscreen();
				isFullscreen = false;
			}
		} );

		window.addEventListener( 'resize', function () {
			camera.aspect = window.innerWidth / window.innerHeight;
			camera.updateProjectionMatrix();
			effect.setSize( window.innerWidth, window.innerHeight );
		}, false );

	}

	function animate() {
		requestAnimationFrame( animate );
		if ( controls !== undefined ) {
			controls.update();
			msg.innerHTML =
				'<table><tr><td>' +
				'oQ.w ' + controls.orientationQuaternion.w.toFixed(3) + '<br>' +
				'oQ.x ' + controls.orientationQuaternion.x.toFixed(3) + '<br>' +
				'oQ.y ' + controls.orientationQuaternion.y.toFixed(3) + '<br>' +
				'oQ.z ' + controls.orientationQuaternion.z.toFixed(3) + '<br>' +
				'aQ.w ' + controls.alignQuaternion.w.toFixed(3) + '<br>' +
				'aQ.x ' + controls.alignQuaternion.x.toFixed(3) + '<br>' +
				'aQ.y ' + controls.alignQuaternion.y.toFixed(3) + '<br>' +
				'aQ.z ' + controls.alignQuaternion.z.toFixed(3) + '<br>' +
				'</td>' +
				'<td>' +
				'alpha ' + controls.alpha.toFixed(3) + '<br>' +
				'beta ' + controls.beta.toFixed(3) + '<br>' +
				'gamma ' + controls.gamma.toFixed(3) + '<br>' +
				'movSpd ' + controls.movementSpeed + '<br>' +
				'rllSpd ' + controls.rollSpeed + '<br>' +
				'</td></tr></table>' +
			'';
		}
		effect.render( scene, camera );
	};

</script>
</body>
</html>
